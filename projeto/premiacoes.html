<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<script src="/projeto/checkManutencao.js" defer></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cidade Alta - Volunt√°rios</title>
<link rel="icon" href="https://cidadealtarp.com/favicon.svg" type="image/svg+xml" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
<style>
  :root {
    --amarelo:#ffbb00; --amarelo-escuro:#cc8800; --cinza-escuro:#333; --preto:#121212;
    --branco:#fff; --transition-speed:0.3s;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    font-family:'Poppins', sans-serif; min-height:100vh; background:var(--preto); color:var(--branco);
    padding:60px 20px 40px; display:flex; flex-direction:column; align-items:center;
    transition: background var(--transition-speed), color var(--transition-speed);
  }
  main.container{
    max-width:900px; width:100%; background:rgba(30,30,30,0.85); border-radius:20px;
    padding:40px 30px 80px; box-shadow:0 10px 25px rgba(0,0,0,0.7); position:relative;
  }
  h1{ font-weight:600; font-size:2.8rem; text-align:center; margin-bottom:40px; color:var(--amarelo); text-shadow:0 0 12px var(--amarelo);}
  .top-left-bar{ position:fixed; top:20px; left:20px; display:flex; align-items:center; gap:15px; z-index:9999;
    background:rgba(30,30,30,0.85); padding:10px 20px; border-radius:14px; box-shadow:0 0 15px var(--amarelo);
  }
  .top-left-bar input[type="search"]{
    font-size:1rem; padding:8px 12px; border-radius:14px; border:none; width:180px; background:var(--cinza-escuro);
    color:var(--branco); box-shadow:0 0 10px rgba(255,187,0,0.6); transition: box-shadow 0.3s ease;
  }
  .top-left-bar input[type="search"]:focus{ outline:none; box-shadow:0 0 15px var(--amarelo);}
  .top-left-bar button#toggle-lang{
    background:var(--amarelo); border:none; border-radius:14px; padding:8px 16px; font-weight:600; color:var(--preto);
    cursor:pointer; font-size:1rem; box-shadow:0 6px 15px rgba(255,187,0,0.7); transition:0.3s ease;
  }
  .top-left-bar button#toggle-lang:hover, .top-left-bar button#toggle-lang:focus{
    background:var(--amarelo-escuro); box-shadow:0 8px 25px rgba(204,136,0,0.9); outline:none; transform:translateY(-3px);
  }
  button#musicToggle{
    position:fixed; top:20px; right:20px; background:var(--amarelo); color:var(--preto); font-weight:600; font-size:1rem;
    padding:10px 20px; border-radius:14px; box-shadow:0 6px 15px rgba(255,187,0,0.7); border:none; cursor:pointer; display:inline-flex;
    align-items:center; gap:8px; z-index:9999; transition:0.3s ease;
  }
  button#musicToggle:hover, button#musicToggle:focus{ background:var(--amarelo-escuro); box-shadow:0 8px 25px rgba(204,136,0,0.9); outline:none; transform:translateY(-3px);}
  .cards{ display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:24px; }
  .card{
    background:#222; border-radius:14px; padding:24px 20px; box-shadow:0 4px 10px rgba(255,187,0,0.2);
    transition:box-shadow 0.3s ease, transform 0.3s ease, opacity 0.5s ease; cursor:default; position:relative;
  }
  .card.hide{ opacity:0; transform:scale(0.9); pointer-events:none; height:0; margin:0; padding:0;}
  .card:hover{ box-shadow:0 12px 30px rgba(255,187,0,0.7); transform:translateY(-6px) scale(1.05);}
  .card h2{ font-weight:600; font-size:1.8rem; color:var(--amarelo); margin-bottom:10px; text-shadow:0 0 6px var(--amarelo);}
  .card p{ font-size:1.1rem; margin-bottom:12px; color:inherit;}
  .top1{ border:3px solid gold; box-shadow:0 0 15px gold; }
  .top2{ border:3px solid silver; box-shadow:0 0 12px silver; }
  .top3{ border:3px solid #cd7f32; box-shadow:0 0 12px #cd7f32; }
  .botoes{ margin-top:50px; display:flex; justify-content:center; gap:30px; flex-wrap:wrap;}
  .botao-planilha, .botao-premiacoes{
    background:var(--amarelo); color:var(--preto); font-weight:600; font-size:1.15rem; padding:14px 30px; border-radius:14px;
    box-shadow:0 6px 15px rgba(255,187,0,0.7); text-decoration:none; transition:0.3s ease; user-select:none; border:none; cursor:pointer;
    display:inline-flex; align-items:center; gap:10px;
  }
  .botao-planilha:hover, .botao-premiacoes:hover, .botao-planilha:focus, .botao-premiacoes:focus{
    background:var(--amarelo-escuro); box-shadow:0 8px 25px rgba(204,136,0,0.9); outline:none; transform:translateY(-3px);
  }
</style>
</head>
<body aria-live="polite" aria-label="Ranking de volunt√°rios Cidade Alta">

<div class="top-left-bar" role="region" aria-label="Barra de busca e sele√ß√£o de idioma">
  <input type="search" id="searchInput" aria-label="Buscar volunt√°rio pelo nome" placeholder="Buscar volunt√°rio..." />
  <button id="toggle-lang" aria-pressed="false" aria-label="Alternar idioma">Ingl√™s</button>
</div>

<button class="botao-music" id="musicToggle" aria-pressed="false" aria-label="Ativar ou desativar m√∫sica">üîà <span>Ativar m√∫sica</span></button>
<audio id="backgroundMusic" loop autoplay src="https://cdn.pixabay.com/download/audio/2021/10/23/audio_9a62fa93a1.mp3?filename=happy-upbeat-joyful-11737.mp3" preload="auto"></audio>

<main class="container" role="main" tabindex="-1">
  <h1>Contagem de horas mensal</h1>
  <section class="cards" aria-label="Lista de volunt√°rios com informa√ß√µes detalhadas" id="volunteerList"></section>

  <section class="botoes" aria-label="Bot√µes para acessar planilhas e tabela de premia√ß√µes">
    <a href="index.html" target="_blank" rel="noopener noreferrer" class="botao-planilha">P√°gina inicial</a>
    <a href="agradecimento.html" target="_blank" rel="noopener noreferrer" class="botao-premiacoes">Agradecimento</a>
  </section>
</main>

<script>
const translations = {
  pt:{title:"Contagem de horas mensal", searchPlaceholder:"Buscar volunt√°rio...", btnMusicOn:"Ativar m√∫sica", btnMusicOff:"Desativar m√∫sica"},
  en:{title:"Monthly Hours Count", searchPlaceholder:"Search volunteer...", btnMusicOn:"Turn music on", btnMusicOff:"Turn music off"}
};
let currentLang='pt';

function getVolunteersFromStorage(){
  const itens=JSON.parse(localStorage.getItem('painel-voluntarios-v2')||'[]');
  return itens.map(it=>({
    id:it.nome.toLowerCase().replace(/\s+/g,'_'),
    pt:{name:it.nome, title:${it.nome}, com excelente dedica√ß√£o e contribui√ß√£o!, hours:it.horas, diamonds:it.diamantes, medal:''},
    en:{name:it.nome, title:${it.nome}, with excellent dedication and contribution!, hours:it.horas, diamonds:it.diamantes, medal:''}
  }));
}
let volunteersData=getVolunteersFromStorage();

function renderCards(filter=''){
  const listEl=document.getElementById('volunteerList');
  listEl.innerHTML='';
  let filtered=volunteersData.filter(v=>v[currentLang].name.toLowerCase().includes(filter.toLowerCase()));
  filtered.sort((a,b)=>b[currentLang].diamonds - a[currentLang].diamonds);
  filtered.forEach((v,idx)=>{
    const card=document.createElement('article'); card.className='card';
    if(idx===0)card.classList.add('top1'); else if(idx===1)card.classList.add('top2'); else if(idx===2)card.classList.add('top3');
    card.tabIndex=0; card.title=v[currentLang].title;
    card.innerHTML=<h2>${v[currentLang].medal? v[currentLang].medal+' ':''}${v[currentLang].name}</h2>
                     <p>üï∞Ô∏è ${v[currentLang].hours} ${currentLang==='pt'?'Horas':'Hours'}</p>
                     <p>üíé ${v[currentLang].diamonds.toLocaleString()} ${currentLang==='pt'?'Diamantes':'Diamonds'}</p>;
    listEl.appendChild(card);
  });
}

window.addEventListener('storage',()=>{
  volunteersData=getVolunteersFromStorage(); renderCards(searchInput.value);
});

const searchInput=document.getElementById('searchInput');
searchInput.addEventListener('input',e=>renderCards(e.target.value));

const musicBtn=document.getElementById('musicToggle');
const music=document.getElementById('backgroundMusic');
musicBtn.addEventListener('click',()=>{
  if(music.paused){
    music.play(); musicBtn.setAttribute('aria-pressed','true');
    musicBtn.querySelector('span').textContent=translations[currentLang].btnMusicOff;
  }else{
    music.pause(); musicBtn.setAttribute('aria-pressed','false');
    musicBtn.querySelector('span').textContent=translations[currentLang].btnMusicOn;
  }
});

const langBtn=document.getElementById('toggle-lang');
langBtn.addEventListener('click',()=>{
  currentLang=currentLang==='pt'?'en':'pt';
  langBtn.textContent=currentLang==='pt'?'Ingl√™s':'Portugu√™s';
  langBtn.setAttribute('aria-pressed',currentLang==='en'?'true':'false');
  document.querySelector('h1').textContent=translations[currentLang].title;
  searchInput.placeholder=translations[currentLang].searchPlaceholder;
  if(music.paused){musicBtn.querySelector('span').textContent=translations[currentLang].btnMusicOn;}
  else{musicBtn.querySelector('span').textContent=translations[currentLang].btnMusicOff;}
  renderCards(searchInput.value);
});

renderCards();
</script>

</body>
</html>
